version: "1"
procs:
  Anvil:
    shell: anvil

  Contracts Setup:
    shell: |
      sleep 5
      forge create Registrator --rpc-url http://localhost:8545 --from 0xa0Ee7A142d267C1f36714E4a8F75612F20a79720 --unlocked
      forge create OffRamper --rpc-url http://localhost:8545 --from 0x90F79bf6EB2c4f870365E785982E1f101E93b906 --unlocked
      forge create PeerFinder --rpc-url http://localhost:8545 --from 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --unlocked
      forge create OnRamper --rpc-url http://localhost:8545 --from 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC --unlocked
      forge create Orchestrator --rpc-url http://localhost:8545 --from 0x23618e81E3f5cdF7f54C3d65f7FBc0aBf5B21E8f --unlocked --constructor-args 0x700b6A60ce7EaaEA56F065753d8dcB9653dbAD35 0x057ef64E23666F000b34aE31332854aCBd1c8544 0x5FbDB2315678afecb367f032d93F642f64180aa3 0x663F3ad617193148711d28f5334eE4Ed07016602
    cwd: "./Contracts"

  Frontend Setup and Start:
    shell: |
      npm install
      npm start
    cwd: "./Frontend/zwift"

  Backend Setup and Start:
    shell: go run server.go
    cwd: "./Backend"

  Database Setup and Start:
    shell: |
      source /Users/michelosswald/main-venv/bin/activate
      sleep 10 #wait for the cockorach server to run
      pip3 install -r ../../requirements.txt
      python3 init_db.py
      uvicorn main:app --reload
    cwd: "./Backend/Database"

  CockroachDB Server:
    shell: cockroach start-single-node --insecure --advertise-addr='127.0.0.1'
